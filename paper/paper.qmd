---
title: "How do lifestyle and poverty influence BMI across different age groups and genders"
subtitle: "Negative Correlations with Poverty and Physical Activity, Positive Correlations with Age, Sleep Duration, and Gender"
author: 
  - Sakura Hu
thanks: "Code and data are available at: [https://github.com/xycww/BMI](https://github.com/xycww/BMI)."
date: today
date-format: long
abstract: "This paper investigates the relationship between BMI and factors such as lifestyle, poverty, age, and gender, aiming to identify patterns that influence maintaining a healthy BMI. The analysis uses the NHANES dataset from the US National Health and Nutrition Examination Survey and applies a multilinear regression model. The findings suggest weak overall correlations between log(BMI) and the predictors, though some significant patterns are observed: BMI is negatively associated with poverty and physical activity levels and positively associated with age, sleep duration, and being male. These results underscore the complexity of factors influencing BMI and highlight potential areas for targeted public health interventions to promote healthier lifestyles."
format: pdf
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(ggplot2)
library(dplyr)
library(knitr)
library(patchwork)
library(arrow)
library(broom)
```


# Introduction

Body mass index (BMI) is a widely used measure for assessing whether an individual's weight is within a healthy range, with significant implications for health outcomes such as heart disease, diabetes, and mortality. Given its importance, understanding the factors that influence BMI, such as socioeconomic and lifestyle variables, has become an essential area of public health research. This paper aims to address the relationship about how variables like poverty, physical activity, age, sleep duration, and gender interact to influence BMI outcomes.

Using data from the US National Health and Nutrition Examination Survey (NHANES), this study models log-transformed BMI as a function of five predictors: poverty level, physical activity frequency (measured in days), age, sleep duration, and gender. A multilinear regression approach was employed to quantify these relationships and identify patterns within the dataset.

The results indicate that while the correlations between BMI and these predictors are generally weak, several significant relationships are observed. Poverty is associated with a 0.01 decrease in log(BMI), suggesting that higher income corresponds to lower BMI levels. Physical activity frequency also demonstrates a negative relationship with BMI; each additional day of physical activity per week is associated with a 0.004 decrease in log(BMI), indicating a modest benefit of regular exercise for maintaining lower BMI. Sleep duration shows a negative relationship, where one additional hour of sleep per night is linked to a 0.01 decrease in log(BMI). In contrast, age is positively associated with BMI, with each additional year corresponding to a 0.001 increase in log(BMI), reflecting the gradual weight gain commonly seen with aging. Lastly, being male is associated with a 0.02 increase in log(BMI) compared to females, suggesting possible physiological or behavioral differences between genders.

These results are essential for informing public health initiatives aimed at addressing weight-related health challenges. By identifying specific socioeconomic and lifestyle factors that influence BMI, this research provides a foundation for developing targeted interventions and strategies to promote healthier weight maintenance.

The remainder of this paper is structured as follows. @sec-data....

# Data {#sec-data}

## Overview

The dataset used in this analysis is derived from the US National Health and Nutrition Examination Survey (NHANES), version 2.1.0. This version of the dataset includes survey results collected between October 2009 and December 2010. NHANES is a long-running study conducted by the US National Center for Health Statistics (NCHS) that has been gathering health and nutrition data since the early 1960s. Since 1999, approximately 5,000 individuals from various age groups have been interviewed annually in their homes and undergone health examinations at mobile examination centers (MEC). 
Two datasets in this package were considered for this analysis: NHANESraw, which is the original raw data, and NHANES, a resampled version of the NHANES data. NHANESraw contains the original survey data with 20,293 observations and additional variables describing the sample weighting scheme, while NHANES is a simplified version with 10,000 resampled observations to account for oversampling effects. NHANES is used in this analysis due to its ability to reduce the potential biases from the complex survey design in NHANESraw. Additional details about this choice are provided in Appendix A. The data used here was originally compiled by Michelle Dalrymple from Cashmere High School and Chris Wild from the University of Auckland for educational purposes.

For the current study, the data was cleaned to focus on variables pertinent to the analysis of BMI. Specifically, variables such as BMI, poverty index, physical activity days, sleep hours, gender, and age were retained. After cleaning the missing values in the dataset, 3,573 observations remained. 

The dataset was prepared, cleaned, and analyzed using R [@citeR] with the following libraries: tidyverse [@tidyverse] and dplyr [@dplyr] for data manipulation, ggplot2 [@ggplot2] and patchwork [@patchwork] for visualizations, and broom [@broom] for model summaries. The arrow [@arrow] library was used for efficient data storage and retrieval, while knitr [@knitr] facilitated report generation. The NHANES package [@nhanes] provided access to the dataset, and styler [@styler] was employed to ensure well-structured R code. Additionally, testthat [@testthat] and pointblank [@pointblank] were utilized for data validation and testing.

A summary table of cleaned data is shown in table 1.


```{r}
#| echo: false
#| label: table-summary
#| tbl-cap: "Summary statistics for variables in the NHANES dataset."

# Load the data
nhanes_data <- read_parquet("/Users/hxw/marriage/data/02-analysis_data/clean_data.parquet")

# Create summary statistics for each variable
summary_table <- nhanes_data %>%
  reframe(
    Variable = c(
      "BMI",
      "log(BMI)",
      "Poverty Index",
      "Physical Activity Days",
      "Age",
      "Sleep Hours"
    ),
    Mean = round(c(
      mean(BMI),
      mean(log(BMI)),
      mean(Poverty),
      mean(PhysActiveDays),
      mean(Age),
      mean(SleepHrsNight)
    ), 3),
    Median = round(c(
      median(BMI),
      median(log(BMI)),
      median(Poverty),
      median(PhysActiveDays),
      median(Age),
      median(SleepHrsNight)
    ), 3),
    Min = round(c(
      min(BMI),
      min(log(BMI)),
      min(Poverty),
      min(PhysActiveDays),
      min(Age),
      min(SleepHrsNight)
    ), 3),
    Max = round(c(
      max(BMI),
      max(log(BMI)),
      max(Poverty),
      max(PhysActiveDays),
      max(Age),
      max(SleepHrsNight)
    ), 3),
    `1st Quantile` = round(
      c(
        quantile(BMI, 0.25),
        quantile(log(BMI), 0.25),
        quantile(Poverty, 0.25),
        quantile(PhysActiveDays, 0.25),
        quantile(Age, 0.25),
        quantile(SleepHrsNight, 0.25)
      ),
      3
    ),
    `3rd Quantile` = round(
      c(
        quantile(BMI, 0.75),
        quantile(log(BMI), 0.75),
        quantile(Poverty, 0.75),
        quantile(PhysActiveDays, 0.75),
        quantile(Age, 0.75),
        quantile(SleepHrsNight, 0.75)
      ),
      3
    )
  )

# Create the summary table using kable
summary_table %>%
  kable()
```


```{r}
#| warning: false
#| message: false
#| label: fig-bmi-logbmi
#| fig-cap: "Distributions of BMI and log(BMI) in the NHANES dataset."
#| echo: false
#| fig.width: 8
#| fig.height: 4

# Create histograms with customized text sizes
hist_bmi <- ggplot(nhanes_data, aes(x = BMI)) +
  geom_histogram(binwidth = 1.5,
                 fill = "lightblue",
                 color = "black") +
  labs(title = "BMI Distribution", x = "BMI", y = "Frequency") +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 14),
    axis.title = element_text(size = 12),
    axis.text = element_text(size = 10)
  )

hist_log_bmi <- ggplot(nhanes_data, aes(x = log(BMI))) +
  geom_histogram(binwidth = 0.1,
                 fill = "lightblue",
                 color = "black") +
  labs(title = "log(BMI) Distribution", x = "log(BMI)", y = "Frequency") +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 14),
    axis.title = element_text(size = 12),
    axis.text = element_text(size = 10)
  )

# Figure 1: BMI and log(BMI)
figure_bmi <- (hist_bmi | hist_log_bmi)
figure_bmi

```


```{r}
#| warning: false
#| message: false
#| label: fig-predictor-distributions
#| fig-cap: "Distributions of predictor variables in the NHANES dataset, including Poverty, Physical Activity Days, Age, Sleep Hours, and Gender."
#| echo: false
#| fig.width: 8
#| fig.height: 12

hist_poverty <- ggplot(nhanes_data, aes(x = Poverty)) +
  geom_histogram(
    binwidth = 0.8,
    fill = "lightgreen",
    color = "black"
  ) +
  labs(title = "Poverty Index Distribution", x = "Poverty Index", y = "Frequency") +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 14),
    axis.title = element_text(size = 12),
    axis.text = element_text(size = 10)
  )

hist_physactive <- ggplot(nhanes_data, aes(x = PhysActiveDays)) +
  geom_histogram(
    binwidth = 1,
    fill = "lightcoral",
    color = "black"
  ) +
  labs(title = "Physical Activity Days Distribution", x = "Physical Activity Days", y = "Frequency") +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 12),
    axis.title = element_text(size = 10),
    axis.text = element_text(size = 8)
  )

hist_age <- ggplot(nhanes_data, aes(x = Age)) +
  geom_histogram(
    binwidth = 3.5,
    fill = "lightyellow",
    color = "black"
  ) +
  labs(title = "Age Distribution", x = "Age", y = "Frequency") +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 12),
    axis.title = element_text(size = 10),
    axis.text = element_text(size = 8)
  )

hist_sleep <- ggplot(nhanes_data, aes(x = SleepHrsNight)) +
  geom_histogram(binwidth = 1,
                 fill = "lightpink",
                 color = "black") +
  labs(title = "Sleep Hours Distribution", x = "Sleep Hours", y = "Frequency") +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 12),
    axis.title = element_text(size = 10),
    axis.text = element_text(size = 8)
  )

hist_gender <- ggplot(nhanes_data, aes(x = Gender)) +
  geom_bar(fill = "lightgray", color = "black") +
  labs(title = "Gender Distribution", x = "Gender", y = "Count") +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 12),
    axis.title = element_text(size = 10),
    axis.text = element_text(size = 8)
  )

# Figure 2: Predictor Variables
figure_predictors <- (hist_poverty | hist_physactive | hist_age) /
  (hist_sleep | hist_gender) +
  plot_annotation(caption = "Figure 2: Distributions of predictor variables in the NHANES dataset, including Poverty, Physical Activity Days, Age, Sleep Hours, and Gender.",
                  theme = theme(plot.caption = element_text(hjust = 0.5, size = 12)))
figure_predictors

```



## Measurement
	
The NHANES dataset aims to provide a comprehensive view of the health and nutritional status of the U.S. population, transforming real-world phenomena into structured data entries. The data collection process begins with the selection of a sample from the U.S. population using a complex, multistage probability sampling design. This ensures that the sample is representative of the civilian, non-institutionalized population, while also oversampling certain subgroups, such as racial minorities, to ensure sufficient data for subgroup analysis. Once selected, individuals are surveyed on various health and lifestyle factors, such as their eating habits, physical activity, medical conditions, and demographics. The participants are then examined in a Mobile Examination Center (MEC) where they undergo physical assessments, laboratory tests, and interviews.

The process of measurement involves both self-reported data and direct observations. For example, data on an individual’s lifestyle habits, such as hours of physical activity, alcohol consumption, or smoking, is obtained through self-reports in interviews. These responses are recorded as variables in the dataset, and any missing values or refusals are appropriately coded. On the other hand, physical measurements like height, weight, blood pressure, and cholesterol levels are directly taken in the MEC using medical equipment. These physical measurements are then processed and entered into the dataset. For each individual, these variables represent their health status at a specific time, providing a snapshot that is used for statistical analysis.

Importantly, NHANES also accounts for missing data, a common occurrence in surveys. Missing values may arise if a participant refuses to answer a particular question or does not undergo a specific examination. These missing values are systematically handled by assigning special codes such as a period (.) for numeric variables or blanks for character variables, ensuring that they are not treated as valid data. Furthermore, to mitigate potential bias due to missing data, adjustments are made using sample weights to produce national estimates that are representative of the U.S. population.

In the case of variables related to health measurements, the data undergo further validation through the use of sampling weights and variance estimation to ensure that the final dataset accurately reflects the population’s health status. This process involves using the complex survey design parameters, such as the primary sampling unit (PSU) and strata, to adjust the data accordingly, so that analyses can account for oversampling of certain subpopulations and non-response during data collection. Thus, every entry in the dataset is an outcome of rigorous data collection methods, reflecting a specific health measure or lifestyle factor that has been transformed into a quantifiable variable, which can then be analyzed and used for public health research.

## Outcome variables

The primary outcome variable in this study is log-transformed BMI, a measure of body mass index adjusted to normalize its distribution. BMI is widely used to assess healthy weight relative to height, and its relevance to health outcomes such as cardiovascular disease and diabetes has been well-established. For this analysis, BMI was log-transformed to address its skewed distribution shown in Figure 1, providing a better fit for statistical modeling.


## Predictor variables
The following predictor variables were examined to assess the potential lifestyle and socio-economic factors influencing BMI:

- `Poverty`: This variable represents the ratio of a family’s income to the federal poverty guidelines, with lower values indicating higher levels of poverty.
- `Physical Activity Days (PhysActiveDays)`: The number of days in a typical week that a participant engages in moderate or vigorous physical activity. This variable is recorded for individuals aged 12 years and older.
- `Sleep Duration (SleepHrsNight)`: The self-reported average number of hours of sleep a participant receives on weekdays or workdays. This variable is recorded for individuals aged 16 years and older.
- `Gender`: The gender of the participant, categorized as male or female.
- `Age`: The participant's age at the time of screening, recorded in years. For participants aged 80 years or older, the age was recorded as 80.

### Distribution of Predictor Variables
The summary statistics presented in Figure 1 and the histograms of predictor variables shown in Figure 3 provide insights into the distribution of these variables:

- `Poverty`: The poverty index ranges from 0 to 5, with a mean of 3.077. The histogram indicates a marked left skew, suggesting that a significant proportion of participants fall into lower income categories.
- `Physical Activity Days (PhysActiveDays)`: The number of days participants engage in physical activity ranges from 2 to 7, with a mean value of 3.7 days per week.
- `Sleep Duration (SleepHrsNight)`:The number of hours participants sleep each night ranges from 2 to 12 hours, with a mean of 6.96 hours. The distribution of this variable approximates a normal curve.
- `Gender`: The gender distribution is nearly balanced, with 1,814 male participants and 1,759 female participants.
- `Age`: The age of participants spans from 16 to 80 years, with a mean age of 43.61 years. The histogram shows a slight right skew, with a concentration of participants aged between 29 and 56 years.


# Model

The goal of our modelling strategy is to use multilinear regression model to investigate the relationship between log(BMI) and poverty, Physical Activity Days, Sleep Duration, gender and age. 
Here we briefly describe the Bayesian analysis model used to investigate... Background details and diagnostics are included in [Appendix -@sec-model-details].

## Model set-up

Define $log(BMI)_i$ as the log(BMI). Then $\beta_i$ are the coefficients associated with each predictor variable, which represent the change in $log(BMI)_i$ for a one-unit change in the corresponding predictor, while holding all other predictors constant.

\begin{equation*} 
\log(\text{BMI}_i) = \beta_0 + \beta_1 \cdot \text{Poverty}_i + \beta_2 \cdot \text{PhysActiveDays}_i + \beta_3 \cdot \text{Age}_i + \beta_4 \cdot \text{SleepHrsNight}_i + \beta_5 \cdot \text{Gender}_i + \epsilon_i
\end{equation*}
\begin{equation*}
\epsilon_i \sim \text{Normal}(0, \sigma^2)
\end{equation*}

We ran the model in R [@citeR] using the lm() function for linear regression, with data manipulation performed using the dplyr package and data reading via the arrow package. No specific priors were applied, as this model relies on ordinary least squares (OLS) estimation, which assumes no prior distributions for the coefficients.


### Model justification
We use a multiple linear regression model to estimate the relationship between body mass index (BMI) and various predictors, including poverty index, physical activity days, age, sleep hours, and gender. The model is designed to predict log-transformed BMI, as this transformation helps normalize the distribution of BMI and address skewness. This approach allows us to explore how these lifestyle and socio-economic factors influence BMI across the sample, using high-quality survey data from the NHANES dataset. We employ predictors like poverty, physical activity, age, sleep hours, and gender to account for key factors that are known to influence BMI, based on existing research.

We use linear regression because it is appropriate for modeling the relationship between a continuous outcome variable (log(BMI)) and predictors physical activity, sleep hours, age, poverty, and gender. This method is straightforward to interpret, and the results could quantify the effect of predictors on BMI, making it a suitable choice for analyzing how these factors relate to BMI.

We chose to log-transform the BMI variable due to its right-skewed distribution. Log-transforming BMI allows us to better meet the assumptions of linear regression by stabilizing variance and making the relationship between BMI and predictors more linear. This is particularly important for ensuring that the model’s estimates are valid and interpretable.

We included the variable 'Poverty' to account for socio-economic status, as previous research has suggested that lower-income individuals tend to have higher BMI levels (Webber et al., 2023). 'PhysActiveDays' was included to capture the effect of physical activity on BMI, as increased physical activity is typically associated with a lower BMI(Webber et al., 2023). Age was included as a predictor to account for the natural changes in BMI that occur as individuals age. Sleep hours were added because there is evidence that insufficient sleep can contribute to weight gain (Ekstedt et al., 2013). Gender was included as a predictor due to well-established gender differences in BMI, with males typically having lower BMI than females (Longo-Silva et al., 2023).

We used the default settings in lm() from the stats package, which assumes normally distributed errors and does not apply any specific prior distributions, as this method does not require priors in the same way that Bayesian methods do. This approach provides a reliable way to assess the linear relationship between the predictors and BMI. However, we acknowledge that other methods, such as Bayesian regression or generalized linear models, could be used for more complex modeling, but this approach was selected for its simplicity and interpretability given the goals of the analysis.

Initially, we considered including interaction terms between predictors (such as between poverty and physical activity). However, when these interaction terms were added, the R-squared value decreased, indicating a reduced fit to the data. Additionally, the residual plot showed a noticeable concentration in the residuals, suggesting potential model misspecification or overfitting. As a result, we decided to exclude interaction terms to maintain a more interpretable and well-fitted model. Future analyses could revisit this approach with a larger dataset or alternative modeling strategies to better account for potential interactions.

By using this model, we aim to better understand the factors that influence BMI and provide insights into potential public health interventions that could target lifestyle changes and socio-economic factors to reduce BMI and related health risks.

# Results

Our results are summarized in @tbl-modelresults.

```{r}
#| warning: false
#| message: false
#| echo: false
#| label: tbl-modelresults
#| tbl-cap: "Summary statistics for variables in the NHANES dataset."

# Load the saved linear model
lm_model <- readRDS("/Users/hxw/marriage/models/lm_model.rds")
# Tidy the model summary
model_summary <- tidy(lm_model)
# Extract R-squared value
r_squared <- summary(lm_model)$r.squared

# Add R-squared to the model summary table
model_summary_with_r2 <- model_summary %>%
  bind_rows(tibble::tibble(
    term = "R-squared",
    estimate = r_squared,
    std.error = NA,
    statistic = NA,
    p.value = NA
  ))

# Print the model summary table using knitr::kable
model_summary_with_r2 %>%
  kable(caption = "Summary of the Linear Model for Log(BMI)")
```

```{r}
#| warning: false
#| message: false
#| echo: false
#| label: fig-predictor-bmi
#| fig-cap: "Scatter plots of predictors vs. log(BMI) with fitted regression lines."
#| fig-subcap: ["Age vs. log(BMI)","Gender vs. log(BMI)", "Poverty vs. log(BMI)", "SleepHrsNight vs. log(BMI)","Physical Active Days vs. log(BMI)"]
#| layout-ncol: 3
#| fig.width: 8
#| fig.height: 12

# Scatter plot for Age vs. log(BMI)
plot_age_bmi <- ggplot(nhanes_data, aes(x = Age, y = log(BMI))) +
  geom_point(size = 0.3) +
  geom_smooth(method = "lm", col = "red", se = FALSE) +
  labs(x = "Age", y = "log(BMI)") +
  theme_minimal() +
  theme(axis.title = element_text(size = 10), axis.text = element_text(size = 8))

# Box plot for Gender vs. log(BMI)
plot_gender_bmi <- ggplot(nhanes_data, aes(x = Gender, y = log(BMI))) +
  geom_boxplot(fill = "lightblue", color = "black") +  # Box plot
  labs(x = "Gender", y = "log(BMI)") +
  theme_minimal() +
  theme(axis.title = element_text(size = 10), axis.text = element_text(size = 8))

# Scatter plot for Poverty vs. log(BMI)
plot_poverty_bmi <- ggplot(nhanes_data, aes(x = Poverty, y = log(BMI))) +
  geom_point(size = 0.3) +
  geom_smooth(method = "lm", col = "red", se = FALSE) +
  labs(x = "Poverty", y = "log(BMI)") +
  theme_minimal() +
  theme(axis.title = element_text(size = 10), axis.text = element_text(size = 8))

# Scatter plot for SleepHrsNight vs. log(BMI)
plot_sleep_bmi <- ggplot(nhanes_data, aes(x = SleepHrsNight, y = log(BMI))) +
  geom_point(size = 0.3) +
  geom_smooth(method = "lm", col = "red", se = FALSE) +
  labs(x = "SleepHrsNight", y = "log(BMI)") +
  theme_minimal() +
  theme(axis.title = element_text(size = 10), axis.text = element_text(size = 8))

# Scatter plot for PhysActiveDays vs. log(BMI)
plot_physactive_bmi <- ggplot(nhanes_data, aes(x = PhysActiveDays, y = log(BMI))) +
  geom_point(size = 0.3) +
  geom_smooth(method = "lm", col = "red", se = FALSE) +
  labs(x = "PhysActiveDays", y = "log(BMI)") +
  theme_minimal() +
  theme(axis.title = element_text(size = 10), axis.text = element_text(size = 8))

plot_age_bmi
plot_gender_bmi
plot_poverty_bmi
plot_sleep_bmi
plot_physactive_bmi

```



# Discussion

## What is done in this paper? {#sec-first-point}

page This paper explores the relationship between Body Mass Index (BMI) and several key lifestyle and demographic factors, including poverty, physical activity, age, sleep duration, and gender. The analysis is performed using a linear regression model, which allows us to estimate how each of these predictors influences BMI, as measured by its log-transformed values. The dataset used for this study is the cleaned data from the US National Health and Nutrition Examination Survey (NHANES), which contains a broad range of health-related information from a representative sample of the U.S. population.

The model aims to quantify the impact of each predictor on BMI while controlling for the influence of other variables. The regression analysis reveals significant relationships between BMI and all the predictors considered, with some factors having a negative impact (e.g., poverty, physical activity) and others having a positive one (e.g., age, sleep hours, gender). This model sheds light on the ways in which various lifestyle choices and demographic factors may contribute to BMI variation across different segments of the population.

The model used in this study, a linear regression model, is a fundamental yet powerful tool that helps to identify the strength and direction of the relationships between predictors and BMI. The results provide a valuable starting point for understanding how changes in lifestyle and demographic factors may affect BMI. However, while the model is useful, it is not without its limitations. For instance, it assumes that the relationships between the predictors and BMI are linear, which may not always be the case. Additionally, the low R-squared value suggests that other important factors influencing BMI may not have been included in the model.

## What is something that we learn about the world?

One of the key findings from this paper is that poverty is negatively correlated with BMI, and the relationship is statistically significant. The negative coefficient for the poverty variable suggests that individuals in poverty tend to have higher BMI, on average, than those with higher income levels. This result is consistent with a growing body of literature that links lower socioeconomic status to obesity and poor health outcomes. It may seem counterintuitive at first—since poverty is often associated with limited access to healthy foods and exercise—but the correlation can be explained by several factors.

In many low-income communities, the availability of affordable healthy food options is limited, leading individuals to rely on cheaper, calorie-dense foods that contribute to weight gain. Additionally, individuals in poverty may face multiple barriers to physical activity, including the lack of access to safe recreational spaces or the time and energy needed to engage in exercise, due to long working hours or other stressors. Furthermore, the high cost of healthcare and medical services in lower-income populations may prevent individuals from seeking preventative care and managing conditions like obesity. Thus, this finding underscores the importance of addressing socioeconomic disparities as part of efforts to combat obesity and improve public health.

Moreover, this finding highlights the need for policy interventions that promote access to healthy food and physical activity in low-income communities. It also suggests that any interventions aimed at reducing BMI must consider not just individual behaviors, but the broader socioeconomic context in which these behaviors occur. Policymakers should prioritize interventions that reduce the barriers to healthy living for individuals in poverty, such as improving access to nutritious food, increasing public health education, and providing community resources for physical activity.

## What is another thing that we learn about the world? 

Another key takeaway from this paper is that sleep duration has a significant negative correlation with BMI, suggesting that individuals who get more sleep tend to have lower BMI. This relationship is in line with previous research that has examined the link between sleep and obesity. The coefficient for sleep hours per night shows that for each additional hour of sleep, BMI decreases slightly, indicating that sleep plays a role in regulating body weight. This finding has important implications for public health, as sleep duration is a modifiable lifestyle factor that could be targeted in weight management programs.

The relationship between sleep and BMI can be explained through several mechanisms. Poor sleep has been shown to disrupt the body's metabolism, leading to an increase in appetite, particularly for high-calorie foods. Sleep deprivation also affects the hormones that regulate hunger and satiety, increasing the production of ghrelin (the hunger hormone) while decreasing the production of leptin (the satiety hormone). These changes can lead to overeating and, consequently, weight gain. Furthermore, insufficient sleep can lead to fatigue, reducing the likelihood of physical activity and further contributing to weight gain. Therefore, improving sleep hygiene and encouraging sufficient sleep may serve as an effective strategy for reducing BMI and addressing obesity.

This result also emphasizes the importance of taking a holistic approach to health. In addition to focusing on diet and physical activity, interventions aimed at improving sleep quality could be a key component in the prevention and treatment of obesity. Public health campaigns that educate individuals about the importance of sleep, along with strategies to improve sleep hygiene (e.g., creating a conducive sleep environment, avoiding caffeine, establishing regular sleep routines), could complement existing efforts to promote healthy eating and physical activity.

## Weaknesses and next steps

While the model results provide valuable insights into the relationship between log(BMI) and various predictor variables, there are some limitations that should be addressed in future analyses. One significant weakness is the relatively low R-squared value of 0.02335, indicating that the model only explains a small portion of the variance in BMI. This suggests that there are other factors, potentially unaccounted for in the model, that influence BMI. Although several predictors show statistically significant relationships with BMI, the explanatory power of the model remains limited. It is possible that additional variables, such as dietary habits, genetics, or environmental factors, could improve the model's ability to explain the variation in BMI.

Another limitation is the potential for omitted variable bias. Despite including a range of relevant predictors, there may be other important factors that have not been incorporated into the model. For instance, socioeconomic status, mental health, or access to healthcare may play significant roles in determining BMI but were not included in the current analysis. Future models could benefit from a more comprehensive selection of predictor variables to provide a more holistic understanding of BMI variation.

Additionally, the model assumes linear relationships between the predictors and BMI, which may not fully capture the complexities of the data. Interaction effects, such as between poverty and physical activity, could potentially reveal more nuanced relationships, but these were not included in the current model. The absence of interaction terms may have led to the underestimation of the impact of certain predictors, as the effect of one variable may depend on the level of another. Future analyses could explore interaction terms to assess whether these improve model fit and offer deeper insights into the factors that influence BMI.

Moving forward, there are several steps that could be taken to address these weaknesses. First, the inclusion of additional predictors could improve the model's explanatory power. Collecting more detailed data on lifestyle, diet, or mental health factors would help provide a more complete picture of the determinants of BMI. Second, using a non-linear model or exploring transformations of the predictors might better capture the relationships between BMI and the explanatory variables. Finally, addressing the possibility of interaction effects and testing different model specifications could enhance the robustness of the results. This could include experimenting with non-parametric models, such as random forests or gradient boosting machines, to better handle the complexities of the data. By expanding the scope of the analysis and refining the model, future work could yield more precise estimates and offer more actionable insights for public health interventions.

\newpage

\appendix

# Appendix {-}


# Additional data details {#sec-data-details}

## Data Justication
The NHANES_raw dataset provides a comprehensive collection of data from the American National Health and Nutrition Examination Surveys (NHANES), including 20,293 observations spanning 75 variables. This dataset includes additional variables that describe the sample weighting scheme employed to account for the complex survey design. However, despite its breadth and richness, NHANES_raw introduces complexities in analysis due to the oversampling of certain subpopulations, such as racial minorities. This sampling approach necessitates the use of survey weights and other design-specific parameters to obtain unbiased estimates and valid statistical inferences.

Naïve analysis of NHANES_raw—without accounting for the sample design and weights—can lead to significant biases and erroneous conclusions. For instance, the racial composition in NHANES_raw does not represent the true demographic distribution of the U.S. population due to oversampling adjustments. As a result, researchers must account for these weights in any analysis to avoid overstating significance levels and generating inaccurate results. This makes NHANES_raw unsuitable for straightforward analysis in contexts where the primary goal is to demonstrate simple statistical relationships, especially for educational purposes.

In contrast, the NHANES dataset, which is a resampled subset of NHANES_raw, addresses the complexities associated with the oversampling design. With 10,000 observations and the same 75 variables, NHANES is simplified to approximate a simple random sample from the U.S. population. This resampling process removes the need for researchers to manually account for the oversampling effects, enabling analyses that are easier to interpret and less prone to methodological errors for educational purposes.

The decision to use NHANES in this paper was driven by its appropriateness for demonstrating relationships between body mass index (BMI) and lifestyle, poverty, age, and gender. NHANES allows for clear and reliable analyses without requiring specialized expertise in survey design or sampling weights, making it ideal for this study’s educational focus. The dataset enables meaningful exploration of public health questions while minimizing the risk of misinterpretation due to unaddressed biases in the sampling framework.

It is important to acknowledge that NHANES is adapted for educational purposes and is not intended for formal research. Researchers conducting advanced studies should rely on the original NHANES_raw data and adhere to the prescribed sampling and weighting procedures to ensure the validity of their findings. Future research could extend the current analysis by using NHANES_raw in combination with survey weighting techniques to explore population-level health trends and disparities with greater accuracy.

# Surveys, Sampling, and Observational Data {#sec-sampling-details}
The National Health and Nutrition Examination Survey (NHANES) represents one of the most comprehensive and influential health datasets in the United States, providing a valuable resource for understanding the health and nutritional status of the U.S. population. Conducted by the National Center for Health Statistics (NCHS), NHANES gathers both interview and physical examination data, which are combined to produce estimates of the general population’s health, nutritional status, and related behaviors. The methodology behind the NHANES survey is complex and carefully designed to ensure that the data collected are representative of the U.S. civilian, non-institutionalized population.

The target population of NHANES consists of the civilian, non-institutionalized population of the United States, including individuals of all ages. This broad and inclusive definition ensures that the data captured by NHANES reflect the health and nutritional status of nearly every demographic group in the country. However, as a complex survey design, NHANES also uses a stratified, multistage sampling approach to select participants, ensuring that certain subgroups, particularly those with greater health disparities, are adequately represented. To achieve this goal, NHANES selects a representative sample from all counties in the U.S. Each year, a new group of PSUs (Primary Sampling Units) is chosen, which typically consist of counties or groups of contiguous counties. A total of about 12,000 people participate in each two-year cycle. This sampling method incorporates differential probabilities of selection, ensuring that groups at higher risk of health issues or underrepresentation (e.g., racial minorities, elderly individuals) are more likely to be sampled. As a result, NHANES oversamples certain subgroups, such as non-Hispanic Black individuals, Hispanic individuals, and elderly individuals over the age of 80, to improve the precision and reliability of health estimates for these populations.

The recruitment process for NHANES is critical to ensuring that the sample is representative and that response rates are maximized. The process begins by selecting households through a multi-stage sampling design. In the first stage, PSUs are chosen using probability proportional to size (PPS), ensuring that more populous areas are selected with higher likelihood. In the second stage, segments within the PSUs are selected—typically representing census blocks or other local geographic units. In the third stage, households within the segments are listed, and a sample of households is chosen. Finally, individuals are selected within these households, using a method that ensures the representation of key demographic characteristics such as age, sex, and race/ethnicity. On average, two participants are chosen per eligible household, which allows the survey to gather a substantial amount of data on family structures, as well as individual health outcomes.

The sampling approach used by NHANES is probabilistic, which means that each person in the target population has a known, non-zero probability of being selected. This is in contrast to deterministic approaches, which might introduce bias by excluding certain groups or individuals from the sample. By employing a probabilistic method, NHANES ensures that its data can be generalized to the entire U.S. population, although care must be taken when analyzing smaller subgroups, given the smaller sample sizes in these categories. One of the trade-offs of this probabilistic sampling approach is the increased complexity of the survey design. Given the multi-stage sampling procedure, survey weights and variance estimation methods must be carefully applied during the data analysis phase to adjust for the unequal probabilities of selection and the clustering of respondents within geographic regions. These adjustments are necessary to avoid biased estimates, particularly when estimating health indicators for subgroups or when combining data across multiple survey cycles.

Non-response is a common challenge in large-scale surveys like NHANES, and its handling is critical to ensuring that the data remain unbiased and representative. Non-response in NHANES can occur at both the unit (or sample person) level and the component (or item) level. Unit non-response refers to individuals who are selected to participate in the survey but either refuse to participate or fail to respond to any part of the survey (e.g., household interview or medical examination). In the 2009-2010 cycle, for example, of the 13,272 persons eligible to participate, 21% failed to complete the household interview, and a further 2% of those who completed the interview did not participate in the medical examination. These non-responses were adjusted for using sampling weights, which are designed to reflect the number of individuals in the population represented by each sample respondent.

Component non-response, on the other hand, refers to missing data for specific questions or tests within the survey. For example, a respondent may refuse to have their blood pressure measured but complete all other examination components. NHANES addresses component non-response by treating missing values as missing and adjusting the weights accordingly. When analyzing the data, researchers are encouraged to evaluate the extent of missing data for their variables of interest and to apply reweighting or imputation techniques if necessary, particularly when more than 10% of the data for a given variable is missing. While NHANES employs rigorous methods to handle non-response, it remains a potential source of bias. Non-respondents may differ in key characteristics from respondents, such as age, gender, or health status. This is particularly true for elderly individuals or those with more severe health issues, who may be less likely to participate in the survey. Therefore, the results of NHANES should always be interpreted with caution, especially when analyzing specific subgroups or when drawing conclusions about less-represented populations.

The NHANES questionnaire and data collection process are designed to capture a comprehensive range of health, nutritional, and demographic information. The questionnaire consists of multiple sections, including detailed questions on demographic characteristics (e.g., age, sex, race, income), health behaviors (e.g., smoking, alcohol consumption, physical activity), and medical history (e.g., chronic diseases, medication use). The questionnaire also covers dietary intake, which is crucial for understanding the population’s nutritional status.

The questionnaire is administered during a household interview, which is followed by a physical examination at the Mobile Examination Centers (MEC). During the MEC visit, participants undergo a range of tests, including anthropometric measurements (e.g., height, weight, BMI), blood pressure measurements, and laboratory tests (e.g., blood, urine samples). The tests performed in the MEC allow for objective measurements of participants’ health, complementing the self-reported information collected during the interview.

The NHANES questionnaire is continuously updated to reflect new public health concerns and emerging health trends. For example, over time, the survey has included questions related to emerging issues such as mental health, sleep patterns, and environmental exposures. However, the questionnaire also has limitations. For example, self-reported data on health behaviors like physical activity or dietary intake may be subject to recall bias, with participants underestimating or overestimating their behaviors. Additionally, some participants may be reluctant to report sensitive information, such as smoking or alcohol consumption, which can further skew the data.

One of the major strengths of the NHANES methodology is its ability to provide nationally representative estimates of health and nutritional status across a wide range of demographic and geographic subgroups. By combining interviews with objective physical examinations and laboratory tests, NHANES offers a rich, multi-dimensional view of health in the U.S. population. The rigorous sampling and data collection procedures ensure that the data can be used for a wide variety of public health analyses, from assessing chronic disease prevalence to tracking health trends over time.

However, NHANES also has several weaknesses. The most notable is the issue of non-response, particularly in certain subgroups (e.g., elderly individuals, people with poor health). While the survey adjusts for non-response using weights, there is always the possibility that the non-respondents differ systematically from the respondents, which could lead to biased estimates. Additionally, the reliance on self-reported data can introduce biases such as social desirability bias or recall bias, which can affect the accuracy of responses on health behaviors and lifestyle factors.

Moreover, the fact that NHANES data are released in two-year cycles means that estimates for some subgroups may not be stable, particularly for rare health conditions or smaller demographic groups. Combining data across multiple years can help mitigate this issue, but it also introduces complexities in terms of data harmonization and analytic guidelines.

In conclusion, NHANES provides a valuable and unique resource for understanding the health and nutritional status of the U.S. population. Its robust sampling methodology, comprehensive questionnaire, and use of both self-reported and objective health measures make it an indispensable tool for public health research. While the survey has several strengths, including its representativeness and ability to assess health trends over time, it also faces challenges related to non-response, data quality, and biases inherent in self-reported information. Researchers must be mindful of these issues when analyzing NHANES data, and apply appropriate statistical methods to account for potential biases. Nonetheless, NHANES remains a cornerstone of U.S. public health surveillance, providing critical insights into the health and well-being of the nation’s diverse population.

# Model details {#sec-model-details}

## Diagnostics

The analysis of linear regression assumptions shows that all conditions are met. The fitted versus residual plot displays a null plot centered around zero, indicating that the linearity assumption is satisfied, as no discernible pattern exists. Additionally, the consistent spread of residuals across the fitted values confirms the constant error variance assumption. The absence of correlation or patterns suggests that the independence of errors is also satisfied. Both the fitted versus standardized residuals plot and the predictor variables versus residuals plots support these conclusions.
The QQ plot shows standardized residuals following a straight diagonal line, while the histogram indicates a distribution close to ~N(0,1), confirming the normality assumption of errors. Lastly, the response variable versus fitted values plot shows that observed values align with predicted values, suggesting that the model accurately predicts the response variable.
Although the residual plots indicate that all regression assumptions are met, the predictor versus response plots show weak correlations between predictor variables and log(BMI

```{r}
#| echo: false
#| label: fig-model-diagnostics
#| fig-cap: "Diagnostic and Predictor Relationships in the Linear Model for log(BMI)."
#| fig-subcap: ["Fitted vs Residuals", "Fitted vs Standardized Residuals", "Histogram of Standardized Residuals", "Poverty vs Residuals", "Age vs Residuals", "Gender vs Residuals", "Fitted vs log(BMI)", "Normal Q-Q Plot"]
#| layout-ncol: 4
#| fig.width: 12
#| fig.height: 18

# Extract values for residuals and fitted values
fitted_values <- fitted(lm_model)
residual_values <- resid(lm_model)
sresidual_values <- rstandard(lm_model)

# Data for scatter plots
scatter_data <- nhanes_data %>%
  mutate(log_BMI = log(BMI))

# Create each plot
# 1. Fitted vs Residuals
plot_fitted_residuals <- ggplot(data.frame(fitted_values, residual_values), 
                                aes(x = fitted_values, y = residual_values)) +
  geom_point(color = "blue", size = 0.3) +
  geom_hline(yintercept = 0, linetype = "dashed") +
  labs(x = "Fitted Values", y = "Residuals") +
  theme_minimal() +
  theme(axis.title = element_text(size = 10), axis.text = element_text(size = 8))

# 2. Fitted vs Standardized Residuals
plot_fitted_standardized <- ggplot(data.frame(fitted_values, sresidual_values), 
                                   aes(x = fitted_values, y = sresidual_values)) +
  geom_point(color = "red", size = 0.3) +
  geom_hline(yintercept = 0, linetype = "dashed") +
  labs(x = "Fitted Values", y = "Standardized Residuals") +
  theme_minimal() +
  theme(axis.title = element_text(size = 10), axis.text = element_text(size = 8))

# 3. Standardized Residuals Histogram
plot_residuals_hist <- ggplot(data.frame(sresidual_values), aes(x = sresidual_values)) +
  geom_histogram(binwidth = 0.1, fill = "lightblue", color = "black") +
  labs(x = "Standardized Residuals", y = "Frequency") +
  theme_minimal() +
  theme(axis.title = element_text(size = 10), axis.text = element_text(size = 8))

# 4. Residuals vs Poverty
plot_residuals_poverty <- ggplot(data.frame(nhanes_data$Poverty, residual_values), 
                                 aes(x = nhanes_data$Poverty, y = residual_values)) +
  geom_point(color = "green", size = 0.3) +
  geom_hline(yintercept = 0, linetype = "dashed") +
  labs(x = "Poverty Index", y = "Residuals") +
  theme_minimal() +
  theme(axis.title = element_text(size = 10), axis.text = element_text(size = 8))

# 5. Residuals vs Age
plot_residuals_age <- ggplot(data.frame(nhanes_data$Age, residual_values), 
                             aes(x = nhanes_data$Age, y = residual_values)) +
  geom_point(color = "orange", size = 0.3) +
  geom_hline(yintercept = 0, linetype = "dashed") +
  labs(x = "Age", y = "Residuals") +
  theme_minimal() +
  theme(axis.title = element_text(size = 10), axis.text = element_text(size = 8))

# 6. Residuals vs Gender
plot_residuals_gender <- ggplot(data.frame(nhanes_data$Gender, residual_values), 
                                aes(x = nhanes_data$Gender, y = residual_values)) +
  geom_boxplot(fill = "gray") +
  labs(x = "Gender", y = "Residuals") +
  theme_minimal() +
  theme(axis.title = element_text(size = 10), axis.text = element_text(size = 8))

# 7. Fitted vs Log(BMI)
plot_fitted_logBMI <- ggplot(data.frame(fitted_values, log_BMI = scatter_data$log_BMI), 
                             aes(x = fitted_values, y = log_BMI)) +
  geom_point(color = "purple", size = 0.3) +
  geom_abline(intercept = 0, slope = 1, color = "blue", linetype = "dashed") +
  labs(x = "Fitted Values", y = "log(BMI)") +
  theme_minimal() +
  theme(axis.title = element_text(size = 10), axis.text = element_text(size = 8))

# 8. Q-Q Plot
plot_qq <- ggplot(data = data.frame(std_resid = rstandard(lm_model)), aes(sample = std_resid)) +
  stat_qq(color = "darkred", size = 0.3) +
  stat_qq_line(color = "blue") +
  labs(x = "Theoretical Quantiles", y = "Standardized Residuals") +
  theme_minimal() +
  theme(axis.title = element_text(size = 10), axis.text = element_text(size = 8))

plot_fitted_residuals
plot_fitted_standardized
plot_residuals_hist
plot_residuals_poverty
plot_residuals_age
plot_residuals_gender
plot_fitted_logBMI
plot_qq

```

\newpage


# References